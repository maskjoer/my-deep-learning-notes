

这项任务自然被视为一个**分布外检测**（Out-of-Distribution Detection）问题，其中模型需要区分样本是从训练数据分布中抽取的，还是来自其支持范围之外的样本。 

具体来说，分布外检测旨在识别那些不属于训练数据所代表的“正常”分布的样本。在实际应用中，这种能力对于处理未知或异常情况非常重要，例如，当模型遇到与其训练数据显著不同的数据时，它能够识别这些数据作为异常，从而采取适当的处理措施。



**贪心的核心集子采样**（Greedy Coreset Subsampling）是一种用于数据压缩和高效处理的技术，特别是在处理大型数据集时。这种方法的核心思想是选择一个较小的子集（即“核心集”）来代表整个数据集，同时尽可能保留数据的关键特征和结构信息。

贪心算法在选择核心集的过程中会逐步进行选择，每一步都选择当前对数据集最有代表性的数据点。具体来说，这种方法的步骤包括：

1. **初始化**：从数据集中随机选择一些样本作为初始核心集。
2. **迭代选择**：逐步选择数据点，使得每次选择都能最大程度地减少与数据集中其他点的距离，从而提高核心集对整个数据集的代表性。
3. **更新**：更新核心集的选择，以便在每一步都包含更多的关键信息。

这种方法的优点是能够在保持计算效率的同时，尽量减少对数据集的重要特征的丢失。贪心的核心集子采样通常用于机器学习模型的训练、数据压缩以及近似计算等场景。





## 框架结构



我们使用 $ X_N $ 来表示在训练时所有正常图像的集合（对于所有  $x \in X_N$ ，有 \( y_x = 0 \)），其中 \( y_x \in \{0, 1\} \) 表示图像 \( x \) 是否正常（0）或异常（1）。

We use \( X_N \) to denote the set of all nominal images $( \forall x \in X_N : y_x = 0 )$ available at training time, with \( y_x \in \{0, 1\} \) denoting if an image \( x \) is nominal (0) or anomalous (1).

Accordingly, we define \( X_T \) to be the set of samples provided at test time, with \( \forall x \in X_T : y_x \in \{0, 1\} \).



公式$[ 
P_{s,p}(\phi_{i,j}) = \{ \phi_{i,j}(N_{(h,w)}^p) \mid h, w \mod s = 0, h < h^*, w < w^*, h, w \in N \}
]$
表示特征图张量 $( \phi_{i,j} ) $的局部感知补丁特征集合。以下是对公式的详细解释：

1. **特征图张量 \( \phi_{i,j} \)**：
   - \( \phi_{i,j} \) 表示从预训练网络中提取的特征图张量，其维度为 \( c^* \times h^* \times w^* \)，其中 \( c^* \) 是深度（特征通道数），\( h^* \) 是高度，\( w^* \) 是宽度。

2. **邻域 \( N_{(h,w)}^p \)**：
   - \( N_{(h,w)}^p \) 指的是以位置 \( (h, w) \) 为中心，邻域大小为 \( p \) 的区域。具体来说，它包括在位置 \( (h, w) \) 周围的一定范围内的所有像素或特征图位置。

3. **自适应平均池化**：
   - \( \phi_{i,j}(N_{(h,w)}^p) \) 表示在邻域 \( N_{(h,w)}^p \) 内进行自适应平均池化后的特征表示。这个操作将邻域内的特征图数据汇总为一个具有预定义维度 \( d \) 的特征向量。

4. **筛选条件**：
   - \( h, w \mod s = 0 \)：选择位置 \( (h, w) \) 使其符合步幅 \( s \) 的条件。这意味着只有在特定间隔的网格位置上（即步幅为 \( s \) 的位置）进行操作。
   - \( h < h^* \) 和 \( w < w^* \)：确保选取的位置 \( (h, w) \) 在特征图的有效范围内。
   - \( h, w \in N \)：确保位置 \( (h, w) \) 属于邻域 \( N \) 的集合。这通常是一个确定的位置集合，用于确保特征提取的局部性。

5. **集合 \( P_{s,p}(\phi_{i,j}) \)**：
   - 该集合包含所有在特征图 \( \phi_{i,j} \) 中，经过自适应平均池化处理后的补丁特征，具体位置为 \( (h, w) \)，这些位置符合步幅 \( s \) 的条件，并且在特征图的有效范围内。

总之，公式描述了如何从特征图张量中提取补丁特征，这些补丁特征是基于特定的步幅和邻域大小，通过自适应平均池化得到的。这个过程有助于保留特征图的空间分辨率，同时增加对小空间变化的鲁棒性。